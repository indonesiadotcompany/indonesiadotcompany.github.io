<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Xenserver provisioning with ansible &middot; Blog Indonesiadot.Com
    
  </title>

  
  <link rel="stylesheet" href="https://blog.indonesiadot.com/css/poole.css">
  <link rel="stylesheet" href="https://blog.indonesiadot.com/css/syntax.css">
  <link rel="stylesheet" href="https://blog.indonesiadot.com/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://blog.indonesiadot.com/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="https://blog.indonesiadot.com/assets/favicon.ico">

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://blog.indonesiadot.com/atom.xml">
</head>


  <body class="theme-base-0c">

    
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Blog dari <a href="https://indonesiadot.com" target="_blank">Indonesiadot.Com</a> adalah tempat menuliskan sesuatu mengenai teknologi, oprek, dan mengenai Indonesiadot.Com.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item " href="https://blog.indonesiadot.com/">Home</a>
    <a class="sidebar-nav-item " href="https://blog.indonesiadot.com/post">Posts</a>

    
    
      
        <a class="sidebar-nav-item " href="https://blog.indonesiadot.com/about/">About</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <a class="sidebar-nav-item " href="https://blog.indonesiadot.com/thanks/">Thanks</a>
      
    

  </nav>

  <div class="sidebar-item">
    <p>&copy; 2019. All rights reserved.</p>
  </div>
</div>


    
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="https://blog.indonesiadot.com/" title="Home">Blog Indonesiadot.Com</a>
            <small>Web log of Indonesiadot.Com, Linux and updated technology</small>
          </h3>
        </div>
      </div>

      <div class="container content">


<div class="post">
  <h1 class="post-title">Xenserver provisioning with ansible</h1>
  <span class="post-date">Mar 19, 2018</span>
  <p><a href="https://medium.com/@jrisch/using-ansible-to-automate-vm-creation-on-xenserver-d092aa484a06">https://medium.com/@jrisch/using-ansible-to-automate-vm-creation-on-xenserver-d092aa484a06</a><br /><br /><br /><section class="section section--body section--first" name="f087"><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 class="graf graf--h3 graf--leading graf--title" id="23c6" name="23c6">Using Ansible to automate VM creation on XenServer</h1><div class="graf graf--p graf-after--h3" id="45dc" name="45dc">I’ve been using Xenserver at <a class="markup--anchor markup--p-anchor" data-href="http://fab-it.dk" href="http://fab-it.dk/" rel="nofollow noopener" target="_blank">Fab:IT</a> for the last 8 or 9 years, and during that time, I’ve automated the  installation of, mostly Debian and Ubuntu, VM’s in several ways. The  most successful way, was a shell script with certain sane defaults built  in, combined with preseed files for the various Debian and Ubuntu  versions, and small shell scripts for handling the installation of  Xentools in the VM, after the initial reboot. I used that script through  <a class="markup--anchor markup--p-anchor" data-href="http://rundeck.org" href="http://rundeck.org/" rel="nofollow noopener" target="_blank">Rundeck</a> to build a selfservice portal for my collegues. It got used, but was not as useful and practical as I wanted it to be.</div><div class="graf graf--p graf-after--p graf--trailing" id="fef2" name="fef2">A little while ago I decided to convert that shell script to an <a class="markup--anchor markup--p-anchor" data-href="https://www.ansible.com" href="https://www.ansible.com/" rel="nofollow noopener" target="_blank">Ansible</a> playbook. By doing so, I gain a bit more flexibility, and makes it  easier for me to maintain. This article is a run-through of the  playbook. The playbook and support files can be found <a class="markup--anchor markup--p-anchor" data-href="https://github.com/jrisch/ansible-xenserver-vm-deploy" href="https://github.com/jrisch/ansible-xenserver-vm-deploy" rel="nofollow noopener" target="_blank">here</a>.</div></div></div></section><section class="section section--body section--last" name="04de"><div class="section-divider"><hr class="section-divider" /></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><div class="graf graf--p graf--leading" id="9982" name="9982"><strong class="markup--strong markup--p-strong">Note</strong>:  a webserver serving the needed preseed files, is a requirement. You can  find an example of a preseed file I use to install Debian Stretch <a class="markup--anchor markup--p-anchor" data-href="https://gist.github.com/jrisch/198cfc8a573359d9070e5a0ef0d762c8" href="https://gist.github.com/jrisch/198cfc8a573359d9070e5a0ef0d762c8" rel="nofollow noopener" target="_blank">here</a>.</div><div class="graf graf--p graf-after--p" id="e2a5" name="e2a5">As the first thing in the playbook, I load in some variables from a file:</div><div class="graf graf--p graf-after--p" id="e2a5" name="e2a5"><br /></div><div class="graf graf--p graf-after--p" id="e2a5" name="e2a5"><a href="https://gist.github.com/jrisch/7142a532f5cb6e3a7e3d6662a9930660#file-xenserver-play-header-yml">xenserver-play-header.yml</a></div><div class="graf graf--p graf-after--p" id="e2a5" name="e2a5"><br /></div><pre>&mdash;<br />- name: Deploy new Debian or Ubuntu VPS<br />  hosts: xenservers<br />  remote_user: root<br />  vars_files:<br />    - xenserver_vars.yml<br /></pre><pre></pre><pre><a href="https://gist.github.com/jrisch/d158179026bb5c1833c847bb7f604144#file-xenserver_vars-yml">xenserver_vars.yml</a></pre><pre></pre><pre>&mdash;<br />hostname: vm01<br />domainname: example.com<br />gateway: 192.168.1.1<br />dnsservers: &ldquo;8.8.8.8&rdquo;<br />network_name: &ldquo;Network 0&rdquo;<br />sr_name: &ldquo;Local storage&rdquo;<br />vm_template: &ldquo;Debian Stretch 9.0 (64-bit)&rdquo;<br />vm_name: &ldquo;vm01&rdquo;<br />ipaddress: 192.168.1.10<br />vps_type: VM-S<br />runtime_environment: testing<br />vcpus: 1</pre><pre></pre><pre><a href="https://gist.github.com/jrisch/60e63982e11fd86a88aed529e573bc55#file-vmtypes-csv">vmtypes.csv</a></pre><pre></pre><pre>Type,Disk,CPU weight,RAM<br />VM-S,26843545600,64,1073741824<br />VM-M,53687091200,256,2147483648<br />VM-L,107374182400,1024,4294967296<br />VM-XL,214748364800,4096,8589934592<br />VM-XXL,536870912000,16384,17179869184<br />VM-XXXL,1073741824000,65536,34359738368</pre><pre></pre></div></div></section><br /><div class="graf graf--p graf-after--figure" id="78db" name="78db">As you can see, Xenserver expects RAM- and disksize in bytes&nbsp;:-( Not that convenient.</div><div class="graf graf--p graf-after--p" id="b338" name="b338">The code that loads these defaults from the csv file, looks like this:</div><br /><a href="https://gist.github.com/jrisch/d3a8bd6d42a9e0eb62f2637348204467#file-task-load-vm-flavours-yml">task-load-vm-flavours.yml</a><br /><br /><pre>    - name: Load VPS specs for chosen type<br />      set_fact:<br />        memory: &ldquo;{{ lookup(&lsquo;csvfile&rsquo;, &lsquo;{{ vps_type }} file=vmtypes.csv delimiter=, col=3&rsquo;) }}&rdquo;<br />        cpu_weight: &ldquo;{{ lookup(&lsquo;csvfile&rsquo;, &lsquo;{{ vps_type }} file=vmtypes.csv delimiter=, col=2&rsquo;) }}&rdquo;<br />        disksize: &ldquo;{{ lookup(&lsquo;csvfile&rsquo;, &lsquo;{{ vps_type }} file=vmtypes.csv delimiter=, col=1&rsquo;) }}&rdquo;</pre><br /><div class="graf graf--p graf-after--figure" id="e493" name="e493">So here  I set the memory, disksize and CPU weight based on the values from the  CSV file. But it’s still possible to override these values later, if  needed.</div><div class="graf graf--p graf-after--p" id="7af8" name="7af8">Next step is to get the UUID’s of some of the resources we want to use when creating the new VM:</div><div class="graf graf--p graf-after--p" id="7af8" name="7af8"><br /></div><div class="graf graf--p graf-after--p" id="7af8" name="7af8"><a href="https://gist.github.com/jrisch/e9d6e394b4117833199452ea98c00a48#file-task-get-uuids-yml">task-get-uuids.yml</a></div><div class="graf graf--p graf-after--p" id="7af8" name="7af8"><br /></div><pre>    - name: Get UUID of share SR<br />      command: xe sr-list name-label=&ldquo;{{ sr_name }}&rdquo; &ndash;minimal<br />      register: sruuid<br /><br />    - name: Get the UUID of the VM template<br />      command: xe template-list name-label=&ldquo;{{ vm_template }}&rdquo; &ndash;minimal<br />      register: templateuuid<br /><br />    - name: Get the UUID of the network<br />      command: xe network-list name-label=&ldquo;{{ network_name }}&rdquo; &ndash;minimal<br />      register: networkuuid</pre><pre></pre><pre>Next step is to create the VM:</pre><pre></pre><pre><a href="https://gist.github.com/jrisch/e9b044c11b97b41bea02d09a051a8c2e#file-task-deploy-new-vm-yml">task-deploy-new-vm.yml</a></pre><pre></pre><pre>    - name: Deploy new VM<br />      command: xe vm-install template={{ templateuuid.stdout }} new-name-label=&ldquo;{{ vm_name }} - {{ ipaddress }} - {{ vps_type }}&rdquo; sr-uuid={{ sruuid.stdout }}<br />      register: vmuuid<br /></pre><pre></pre><pre>And set some of the properties:</pre><pre></pre><pre><a href="https://gist.github.com/jrisch/4233c0f8d097ab03f17b371d3d921ce9#file-task-vm-properties-yml">task-vm-properties.yml</a></pre><pre></pre><pre>    - name: Set vcpu priority<br />      command: xe vm-param-set VCPUs-params:weight={{ cpu_weight }} uuid={{ vmuuid.stdout }}<br /><br />    - name: Set vcpu count max<br />      command: xe vm-param-set VCPUs-max={{ vcpu_count }} uuid={{ vmuuid.stdout }}<br />      when: vcpu_count &gt;= &ldquo;2&rdquo;<br /><br />    - name: Set vcpu count at startup<br />      command: xe vm-param-set VCPUs-at-startup={{ vcpu_count }} uuid={{ vmuuid.stdout }}<br />      when: vcpu_count &gt;= &ldquo;2&rdquo;</pre><pre></pre><pre>For the disk, we have to get the UUID first, and then set the disksize:</pre><pre></pre><pre><a href="https://gist.github.com/jrisch/688241a14b55c263005e148ba41bb5ef#file-task-set-disksize-yml">task-set-disksize.yml</a></pre><pre></pre><pre>    - name: Get the UUID of the disk<br />      command: xe vm-disk-list vbd-params=device=xvda uuid={{ vmuuid.stdout }} &ndash;minimal<br />      register: vdiuuid<br /><br />    - name: Set disk size<br />      command: xe vdi-resize disk-size=&ldquo;{{ disksize }}&rdquo; uuid={{ vdiuuid.stdout }}</pre><pre></pre><pre>Here we set the memory and attach the VM to the desired network:</pre><pre></pre><pre><a href="https://gist.github.com/jrisch/d6ed395ad71b8d13f18544af35ffae62#file-task-set-mem-and-network-yml">task-set-mem-and-network.yml</a></pre><pre></pre><pre>    - name: Set memory<br />      command: xe vm-memory-limits-set uuid={{ vmuuid.stdout }} dynamic-min=&ldquo;{{ memory }}&rdquo; dynamic-max=&ldquo;{{ memory }}&rdquo; static-max=&ldquo;{{ memory }}&rdquo; static-min=&ldquo;{{ memory }}&rdquo;<br /><br />    - name: Attach VM to {{ network_name }}<br />      command: xe vif-create vm-uuid={{ vmuuid.stdout }} network-uuid={{ networkuuid.stdout }} mac=random device=0</pre><pre></pre><pre>Next we set the bootargs, based on the chosen template:</pre><pre></pre><pre><a href="https://gist.github.com/jrisch/5ee28dce072557970b967a73c11adfc0#file-task-set-bootargs-yml">task-set-bootargs.yml</a></pre><pre></pre><pre>    - name: Load bootargs and install repo for Debian install<br />      include_vars:<br />        file=group_vars/Debian.yml<br />      when: &lsquo;&ldquo;Debian&rdquo; in vm_template&rsquo;<br /><br />    - name: Load bootargs and install repo for Ubuntu install<br />      include_vars:<br />        file=group_vars/Ubuntu.yml<br />      when: &lsquo;&ldquo;Ubuntu&rdquo; in vm_template&rsquo;<br /><br />    - name: Set preseed boot options<br />      command: xe vm-param-set uuid={{ vmuuid.stdout }} PV-args=&ldquo;{{ boot_args }}&rdquo;<br /><br />    - name: Set install repository<br />      command: xe vm-param-set uuid={{ vmuuid.stdout }} other-config:install-repository={{ install_repository }}<br /></pre><pre></pre><pre>And we need a cdrom drive for installing Xentools:</pre><pre></pre><pre><a href="https://gist.github.com/jrisch/299ee82bd8c4ebff0be439c598706409#file-task-create-cdrom-yml">task-create-cdrom.yml</a></pre><pre></pre><pre>    - name: Create and attach CDROM drive<br />      command: xe vbd-create type=CD device=xvdd vm-uuid={{ vmuuid.stdout }} mode=ro</pre><pre></pre><pre>Now we just have to boot the VM and wait for the first reboot, so we can insert the Xentools CD:</pre><pre></pre><pre><a href="https://gist.github.com/jrisch/c8942e4367bc6c59cef2486110a1e608#file-task-boot-vm-yml">task-boot-vm.yml</a></pre><pre></pre><pre>    - name: Boot VM and start preseed installation<br />      command: xe vm-start uuid={{ vmuuid.stdout }}<br /><br />    - name: Get the boot time for the VM<br />      command: xe vm-param-get param-name=start-time  uuid={{ vmuuid.stdout}}<br />      register: boottime<br /><br />    - name: Watch for the first reboot<br />      shell: export starttime={{ boottime.stdout }}; while [[ ${starttime} == {{ boottime.stdout }} ]]; do sleep 15; starttime=<code>xe vm-param-get param-name=start-time uuid={{ vmuuid.stdout }}</code>; done<br />      async: 1800<br />      poll: 15</pre><pre></pre><pre>When the VM is installed, and has rebooted for the first time, Ansible <br />will return and continue with inserting the Xentools CD. The name of the<br /> ISO image has changed from Xenserver 6 to Xenserver 7, so we have to <br />check the Xenserver version, to know which name to use:</pre><pre></pre><pre><a href="https://gist.github.com/jrisch/28322a40d5b370643873c36881e5466b#file-task-insert-xentools-cd-yml">task-insert-xentools-cd.yml</a></pre><pre></pre><pre>    - name: Insert Xentools CD in CDROM drive<br />      command: xe vm-cd-insert cd-name=xs-tools.iso vm={{ vmuuid.stdout }}<br />      when: ansible_distribution_major_version|int &lt;= 6<br /><br />    - name: Insert Xentools CD in CDROM drive<br />      command: xe vm-cd-insert cd-name=guest-tools.iso vm={{ vmuuid.stdout }}<br />      when: ansible_distribution_major_version|int &gt;= 7<br /><br />    - name: Get the last boot time for the VM<br />      command: xe vm-param-get param-name=start-time  uuid={{ vmuuid.stdout}}<br />      register: boottime<br /><br />    - name: Watch for the last reboot<br />      shell: export starttime={{ boottime.stdout }}; while [[ ${starttime} == {{ boottime.stdout }} ]]; do sleep 15; starttime=<code>xe vm-param-get param-name=start-time uuid={{ vmuuid.stdout }}</code>; done<br />      async: 1800<br />      poll: 15</pre><pre></pre><pre>Now we add the new vm to a dynamic host group, that we can use in the next part of the play:</pre><pre></pre><pre><a href="https://gist.github.com/jrisch/388f3fbdeb23fefe8591f5b61dfeb7f2#file-task-add-dynamic-host-yml">task-add-dynamic-host.yml</a></pre><pre></pre><pre>    - name: Add host to runtime inventory<br />      add_host:<br />        name=&ldquo;{{ ipaddress }}&rdquo;<br />        groups=&ldquo;deployed_vms&rdquo;</pre><pre></pre><pre>Then we connect to the new vm, mount the CD, install xentools and lastly, connect to the Xenserver and eject the CD:</pre><pre></pre><pre><a href="https://gist.github.com/jrisch/a1f27bd775f3d9e00fc73e50e73d2b6b#file-play-install-xentools-yml">play-install-xentools.yml</a></pre><pre></pre><pre>- name: Install Xentools on deployed vm<br />  hosts: deployed_vms<br /><br />  tasks:<br /><br />    - name: Mount xentools CD<br />      command: mount /dev/xvdd /mnt<br /><br />    - name: Run the xentools installer<br />      command: /mnt/Linux/install.sh -n<br /><br />    - name: Unmount the xentools CD<br />      command: umount /mnt<br /><br />- name: Eject xentools CD<br />  hosts: xenservers<br /><br />  tasks:<br /><br />    - name: Eject the xentools CD<br />      command: xe vm-cd-eject vm={{ vmuuid.stdout }}</pre><pre></pre><pre>These last steps is encapsulated in separate plays.</pre><div class="graf graf--p graf-after--p" id="7af8" name="7af8"><br /></div><b><a href="https://medium.com/@jrisch/using-ansible-and-awx-to-deploy-vms-on-xenserver-309798a060b5">https://medium.com/@jrisch/using-ansible-and-awx-to-deploy-vms-on-xenserver-309798a060b5</a></b><br /><h1 class="graf graf--h3 graf-after--figure graf--title" id="3063" name="3063">Using Ansible and AWX to deploy VMs on Xenserver</h1><div class="graf graf--p graf-after--h3" id="c8a5" name="c8a5">This article builds upon my previous one, “<a class="markup--anchor markup--p-anchor" data-href="https://medium.com/@jrisch/using-ansible-to-automate-vm-creation-on-xenserver-d092aa484a06" href="https://medium.com/@jrisch/using-ansible-to-automate-vm-creation-on-xenserver-d092aa484a06" target="_blank">Using Ansible to automate VM creation on XenServer</a>.” This time we deploy <a class="markup--anchor markup--p-anchor" data-href="https://github.com/ansible/awx" href="https://github.com/ansible/awx" rel="nofollow noopener" target="_blank">Ansible AWX</a> (Open Source version of Ansible Tower) to docker via <a class="markup--anchor markup--p-anchor" data-href="https://docs.docker.com/compose/overview/" href="https://docs.docker.com/compose/overview/" rel="nofollow noopener" target="_blank">Docker Compose</a>, and use the <a class="markup--anchor markup--p-anchor" data-href="https://github.com/jrisch/ansible-xenserver-vm-deploy" href="https://github.com/jrisch/ansible-xenserver-vm-deploy" rel="nofollow noopener" target="_blank">playbook</a> we created last time to build an “automation portal” for deploying new VM’s on Xenserver.</div><div class="graf graf--p graf-after--p" id="0b7c" name="0b7c">We  start by creating a docker-compose.yml file, for running AWX in  containers on a local Docker instance. As this is just a test/POC, we  use local volumes. This docker compose file can easily be changed to be  deployed on <a class="markup--anchor markup--p-anchor" data-href="https://rancher.com" href="https://rancher.com/" rel="nofollow noopener" target="_blank">Rancher</a> fx.</div><figure class="graf graf--figure graf--iframe graf-after--p" id="bebc" name="bebc"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 269.571%;"></div><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"></div></div></figure><figure class="graf graf--figure graf--iframe graf-after--p" id="bebc" name="bebc"><div class="aspectRatioPlaceholder is-locked"><div class="progressiveMedia js-progressiveMedia is-canvasLoaded is-imageLoaded" data-scroll="native"><div class="iframeContainer"><iframe allowfullscreen="" class="progressiveMedia-iframe js-progressiveMedia-iframe" data-media-id="36387e58dc2d078559386b249ee168bc" data-src="https://blog.indonesiadot.com/media/36387e58dc2d078559386b249ee168bc?postId=309798a060b5" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F8949%3Fs%3D400%26v%3D4&amp;key=a19fcc184b9711e1b4764040d3dc5c07" frameborder="0" height="250" src="https://medium.com/media/36387e58dc2d078559386b249ee168bc?postId=309798a060b5" width="700"></iframe></div></div></div><figcaption class="imageCaption">Docker Compose file for local AWX installation</figcaption></figure><div class="graf graf--p graf-after--figure" id="beb2" name="beb2">Next, we just start the AWX service stack, with:</div><pre class="graf graf--pre graf-after--p" id="a352" name="a352">docker-compose up -d</pre><div class="graf graf--p graf-after--pre" id="6aaf" name="6aaf">It  takes a while for the AWX stack to start, as it has to download all the  docker images, start the PostgreSQL server, start the containers and  load in the database scheme. Once its finished, you can access the web  interface on <a class="markup--anchor markup--p-anchor" data-href="http://localhost" href="http://localhost/" target="_blank"><a href="http://localhost">http://localhost</a></a> and you will be met by a login dialog:</div><figure class="graf graf--figure graf-after--p" id="b8d2" name="b8d2"><div class="aspectRatioPlaceholder is-locked" style="max-height: 484px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 69.19999999999999%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*77g5r91zKkOCe9WDkGZdKw.png" data-action="zoom" data-height="866" data-image-id="1*77g5r91zKkOCe9WDkGZdKw.png" data-scroll="native" data-width="1252"></div></div></figure><figure class="graf graf--figure graf-after--p" id="b8d2" name="b8d2"><div class="aspectRatioPlaceholder is-locked" style="max-height: 484px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*77g5r91zKkOCe9WDkGZdKw.png" data-action="zoom" data-height="866" data-image-id="1*77g5r91zKkOCe9WDkGZdKw.png" data-scroll="native" data-width="1252"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*77g5r91zKkOCe9WDkGZdKw.png" src="https://cdn-images-1.medium.com/max/800/1*77g5r91zKkOCe9WDkGZdKw.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="995d" name="995d">After you’ve logged in the first thing to do is create a new project. Go to <strong class="markup--strong markup--p-strong">Projects</strong> and create a new one. Here, I’ve named it Xenserver VM Deploy, and  chosen the Git SCM type, added the URL of the playbook repo from GitHub,  set some SCM Update Options and a cache timout of 4 hours.</div><figure class="graf graf--figure graf-after--p" id="8bc7" name="8bc7"><div class="aspectRatioPlaceholder is-locked" style="max-height: 357px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 50.9%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*r1SGvqhtALnxBIQ9HezDyQ.png" data-action="zoom" data-height="1236" data-image-id="1*r1SGvqhtALnxBIQ9HezDyQ.png" data-scroll="native" data-width="2426"></div></div></figure><figure class="graf graf--figure graf-after--p" id="8bc7" name="8bc7"><div class="aspectRatioPlaceholder is-locked" style="max-height: 357px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*r1SGvqhtALnxBIQ9HezDyQ.png" data-action="zoom" data-height="1236" data-image-id="1*r1SGvqhtALnxBIQ9HezDyQ.png" data-scroll="native" data-width="2426"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*r1SGvqhtALnxBIQ9HezDyQ.png" src="https://cdn-images-1.medium.com/max/800/1*r1SGvqhtALnxBIQ9HezDyQ.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="0cb1" name="0cb1">Next up we need a credential for connecting to the Xenservers. Here you have to navigate to <a class="markup--anchor markup--p-anchor" data-href="http://localhost/#/credentials" href="http://localhost/#/credentials" target="_blank">Credentials</a> and create a new one. Choose <strong class="markup--strong markup--p-strong">Machine</strong> as the credential type (SSH key) and press Select.</div><figure class="graf graf--figure graf-after--p" id="ebd3" name="ebd3"><div class="aspectRatioPlaceholder is-locked" style="max-height: 538px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 76.9%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*oAWfSZyXNu7v1WMSS9MrAA.png" data-action="zoom" data-height="932" data-image-id="1*oAWfSZyXNu7v1WMSS9MrAA.png" data-scroll="native" data-width="1212"></div></div></figure><figure class="graf graf--figure graf-after--p" id="ebd3" name="ebd3"><div class="aspectRatioPlaceholder is-locked" style="max-height: 538px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*oAWfSZyXNu7v1WMSS9MrAA.png" data-action="zoom" data-height="932" data-image-id="1*oAWfSZyXNu7v1WMSS9MrAA.png" data-scroll="native" data-width="1212"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*oAWfSZyXNu7v1WMSS9MrAA.png" src="https://cdn-images-1.medium.com/max/800/1*oAWfSZyXNu7v1WMSS9MrAA.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="173a" name="173a">Now  you have to provide the private key, of a keypair that has full access  to your Xenservers. You can choose to have AWX prompt you for the  passphrase for the private key on job launch, or type it in at let AWX  save it in encrypted form in the database. Save the key.</div><figure class="graf graf--figure graf-after--p" id="d6f4" name="d6f4"><div class="aspectRatioPlaceholder is-locked" style="max-height: 450px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 64.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*9_NRHwOvtP5I9k5r3j3bxw.png" data-action="zoom" data-height="1550" data-image-id="1*9_NRHwOvtP5I9k5r3j3bxw.png" data-scroll="native" data-width="2412"></div></div></figure><figure class="graf graf--figure graf-after--p" id="d6f4" name="d6f4"><div class="aspectRatioPlaceholder is-locked" style="max-height: 450px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*9_NRHwOvtP5I9k5r3j3bxw.png" data-action="zoom" data-height="1550" data-image-id="1*9_NRHwOvtP5I9k5r3j3bxw.png" data-scroll="native" data-width="2412"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*9_NRHwOvtP5I9k5r3j3bxw.png" src="https://cdn-images-1.medium.com/max/800/1*9_NRHwOvtP5I9k5r3j3bxw.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="2258" name="2258">When it’s saved, you can’t see or copy the private key anymore, only replace it.</div><figure class="graf graf--figure graf-after--p" id="628b" name="628b"><div class="aspectRatioPlaceholder is-locked" style="max-height: 106px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 15.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*H8RiWq_fRgV7YcE6RaYznw.png" data-action="zoom" data-height="354" data-image-id="1*H8RiWq_fRgV7YcE6RaYznw.png" data-scroll="native" data-width="2342"></div></div></figure><figure class="graf graf--figure graf-after--p" id="628b" name="628b"><div class="aspectRatioPlaceholder is-locked" style="max-height: 106px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*H8RiWq_fRgV7YcE6RaYznw.png" data-action="zoom" data-height="354" data-image-id="1*H8RiWq_fRgV7YcE6RaYznw.png" data-scroll="native" data-width="2342"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*H8RiWq_fRgV7YcE6RaYznw.png" src="https://cdn-images-1.medium.com/max/800/1*H8RiWq_fRgV7YcE6RaYznw.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="5c4f" name="5c4f">Now  we have to create an inventory of Xenservers to deploy to. As you may  recall, our Github repo actually contains an inventory file that we’ll  use, directly from the project. Go to <strong class="markup--strong markup--p-strong">Inventories</strong> and create a new one, give it a name and save it.</div><figure class="graf graf--figure graf-after--p" id="fac7" name="fac7"><div class="aspectRatioPlaceholder is-locked" style="max-height: 291px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 41.5%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*p3RPm1q9rdZ-kJgbeq-CXQ.png" data-action="zoom" data-height="1006" data-image-id="1*p3RPm1q9rdZ-kJgbeq-CXQ.png" data-scroll="native" data-width="2424"></div></div></figure><figure class="graf graf--figure graf-after--p" id="fac7" name="fac7"><div class="aspectRatioPlaceholder is-locked" style="max-height: 291px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*p3RPm1q9rdZ-kJgbeq-CXQ.png" data-action="zoom" data-height="1006" data-image-id="1*p3RPm1q9rdZ-kJgbeq-CXQ.png" data-scroll="native" data-width="2424"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*p3RPm1q9rdZ-kJgbeq-CXQ.png" src="https://cdn-images-1.medium.com/max/800/1*p3RPm1q9rdZ-kJgbeq-CXQ.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="a4f5" name="a4f5">Then go to the <strong class="markup--strong markup--p-strong">Sources</strong> tab and press <strong class="markup--strong markup--p-strong">Add Source</strong>.</div><figure class="graf graf--figure graf-after--p" id="8468" name="8468"><div class="aspectRatioPlaceholder is-locked" style="max-height: 239px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 34.2%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*2k51eZ2euWCyVmLUoA3cGg.png" data-action="zoom" data-height="826" data-image-id="1*2k51eZ2euWCyVmLUoA3cGg.png" data-scroll="native" data-width="2418"></div></div></figure><figure class="graf graf--figure graf-after--p" id="8468" name="8468"><div class="aspectRatioPlaceholder is-locked" style="max-height: 239px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*2k51eZ2euWCyVmLUoA3cGg.png" data-action="zoom" data-height="826" data-image-id="1*2k51eZ2euWCyVmLUoA3cGg.png" data-scroll="native" data-width="2418"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*2k51eZ2euWCyVmLUoA3cGg.png" src="https://cdn-images-1.medium.com/max/800/1*2k51eZ2euWCyVmLUoA3cGg.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="c672" name="c672">Then give Inventory souce a name, choose <strong class="markup--strong markup--p-strong">Sourced from a Project</strong>,  the Project to source from (the project that we created earlier) and  the specific file to use as inventory file (here we use the hosts file).  Then choose <strong class="markup--strong markup--p-strong">Update on Project Change</strong> and press <strong class="markup--strong markup--p-strong">Save</strong>.</div><figure class="graf graf--figure graf-after--p" id="f05d" name="f05d"><div class="aspectRatioPlaceholder is-locked" style="max-height: 389px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 55.50000000000001%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*CsNBAHEbsIsGljg5i4JJEA.png" data-action="zoom" data-height="1344" data-image-id="1*CsNBAHEbsIsGljg5i4JJEA.png" data-scroll="native" data-width="2420"></div></div></figure><figure class="graf graf--figure graf-after--p" id="f05d" name="f05d"><div class="aspectRatioPlaceholder is-locked" style="max-height: 389px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*CsNBAHEbsIsGljg5i4JJEA.png" data-action="zoom" data-height="1344" data-image-id="1*CsNBAHEbsIsGljg5i4JJEA.png" data-scroll="native" data-width="2420"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*CsNBAHEbsIsGljg5i4JJEA.png" src="https://cdn-images-1.medium.com/max/800/1*CsNBAHEbsIsGljg5i4JJEA.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="3823" name="3823">We now have to create a new Job template. Go to <strong class="markup--strong markup--p-strong">Job Templates</strong> and press <strong class="markup--strong markup--p-strong">Add-&gt;New Job Template</strong>. Give the new job template a name, choose <strong class="markup--strong markup--p-strong">Run</strong> as Job Type, the inventory we created earlier, the project we created  earlier and which playbook to run. Then select the credential we’ve  created, set the options you want and press <strong class="markup--strong markup--p-strong">Save</strong>.</div><div class="graf graf--p graf-after--p" id="f429" name="f429"><strong class="markup--strong markup--p-strong">Note</strong>: I had problems with AWX not recognising that I’d chosen a credential for the job. To solve this, I checked the <strong class="markup--strong markup--p-strong">Prompt on Launch</strong> checkbox besides the <strong class="markup--strong markup--p-strong">Credential</strong> box. This let’s you choose which credential you want to use, when running the job. More on that later.</div><figure class="graf graf--figure graf-after--p" id="da98" name="da98"><div class="aspectRatioPlaceholder is-locked" style="max-height: 484px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 69.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*5xal4VgZtyoA9GR9Y4ZkhQ.png" data-action="zoom" data-height="1666" data-image-id="1*5xal4VgZtyoA9GR9Y4ZkhQ.png" data-scroll="native" data-width="2410"></div></div></figure><figure class="graf graf--figure graf-after--p" id="da98" name="da98"><div class="aspectRatioPlaceholder is-locked" style="max-height: 484px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*5xal4VgZtyoA9GR9Y4ZkhQ.png" data-action="zoom" data-height="1666" data-image-id="1*5xal4VgZtyoA9GR9Y4ZkhQ.png" data-scroll="native" data-width="2410"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*5xal4VgZtyoA9GR9Y4ZkhQ.png" src="https://cdn-images-1.medium.com/max/800/1*5xal4VgZtyoA9GR9Y4ZkhQ.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="5359" name="5359">To  ease the deployment process, especially for non-tech savvy people,  we’ll create a survey, that asks for input from the user running the  job. Click on <strong class="markup--strong markup--p-strong">Add Survey</strong>.</div><div class="graf graf--p graf-after--p" id="c8d6" name="c8d6">We only add the fields that is required for deploying af VM using this playbook. Add a survey prompt for the <strong class="markup--strong markup--p-strong">Hostname</strong>. Press <strong class="markup--strong markup--p-strong">Add</strong>.</div><figure class="graf graf--figure graf-after--p" id="b186" name="b186"><div class="aspectRatioPlaceholder is-locked" style="max-height: 795px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 113.6%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*oI_5xD9OqekfuVtDfps24w.png" data-action="zoom" data-height="1372" data-image-id="1*oI_5xD9OqekfuVtDfps24w.png" data-scroll="native" data-width="1208"></div></div></figure><figure class="graf graf--figure graf-after--p" id="b186" name="b186"><div class="aspectRatioPlaceholder is-locked" style="max-height: 795px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*oI_5xD9OqekfuVtDfps24w.png" data-action="zoom" data-height="1372" data-image-id="1*oI_5xD9OqekfuVtDfps24w.png" data-scroll="native" data-width="1208"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*oI_5xD9OqekfuVtDfps24w.png" src="https://cdn-images-1.medium.com/max/800/1*oI_5xD9OqekfuVtDfps24w.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="b6a6" name="b6a6">Add a survey prompt for the <strong class="markup--strong markup--p-strong">Domain Name</strong>. Press <strong class="markup--strong markup--p-strong">Add</strong>.</div><figure class="graf graf--figure graf-after--p" id="aa3d" name="aa3d"><div class="aspectRatioPlaceholder is-locked" style="max-height: 799px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 114.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*KXaBkNYnyIUw6p1MrWG-eQ.png" data-action="zoom" data-height="1376" data-image-id="1*KXaBkNYnyIUw6p1MrWG-eQ.png" data-scroll="native" data-width="1206"></div></div></figure><figure class="graf graf--figure graf-after--p" id="aa3d" name="aa3d"><div class="aspectRatioPlaceholder is-locked" style="max-height: 799px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*KXaBkNYnyIUw6p1MrWG-eQ.png" data-action="zoom" data-height="1376" data-image-id="1*KXaBkNYnyIUw6p1MrWG-eQ.png" data-scroll="native" data-width="1206"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*KXaBkNYnyIUw6p1MrWG-eQ.png" src="https://cdn-images-1.medium.com/max/800/1*KXaBkNYnyIUw6p1MrWG-eQ.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="d6da" name="d6da">Add a survey prompt for the <strong class="markup--strong markup--p-strong">Gateway</strong>. Press <strong class="markup--strong markup--p-strong">Add</strong>.</div><figure class="graf graf--figure graf-after--p" id="abeb" name="abeb"><div class="aspectRatioPlaceholder is-locked" style="max-height: 809px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 115.6%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*ld96DM61ignFJX8y0GrDSA.png" data-action="zoom" data-height="1396" data-image-id="1*ld96DM61ignFJX8y0GrDSA.png" data-scroll="native" data-width="1208"></div></div></figure><figure class="graf graf--figure graf-after--p" id="abeb" name="abeb"><div class="aspectRatioPlaceholder is-locked" style="max-height: 809px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*ld96DM61ignFJX8y0GrDSA.png" data-action="zoom" data-height="1396" data-image-id="1*ld96DM61ignFJX8y0GrDSA.png" data-scroll="native" data-width="1208"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*ld96DM61ignFJX8y0GrDSA.png" src="https://cdn-images-1.medium.com/max/800/1*ld96DM61ignFJX8y0GrDSA.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="8039" name="8039">Add a survey prompt for the <strong class="markup--strong markup--p-strong">VM Name</strong>. Press <strong class="markup--strong markup--p-strong">Add</strong>.</div><figure class="graf graf--figure graf-after--p" id="b892" name="b892"><div class="aspectRatioPlaceholder is-locked" style="max-height: 808px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 115.39999999999999%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*UYdbcGv3XWm2EoT5T4Tdfw.png" data-action="zoom" data-height="1392" data-image-id="1*UYdbcGv3XWm2EoT5T4Tdfw.png" data-scroll="native" data-width="1206"></div></div></figure><figure class="graf graf--figure graf-after--p" id="b892" name="b892"><div class="aspectRatioPlaceholder is-locked" style="max-height: 808px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*UYdbcGv3XWm2EoT5T4Tdfw.png" data-action="zoom" data-height="1392" data-image-id="1*UYdbcGv3XWm2EoT5T4Tdfw.png" data-scroll="native" data-width="1206"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*UYdbcGv3XWm2EoT5T4Tdfw.png" src="https://cdn-images-1.medium.com/max/800/1*UYdbcGv3XWm2EoT5T4Tdfw.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="fd76" name="fd76">Add a survey prompt for the <strong class="markup--strong markup--p-strong">IP Address</strong>. Press <strong class="markup--strong markup--p-strong">Add</strong>.</div><figure class="graf graf--figure graf-after--p" id="877b" name="877b"><div class="aspectRatioPlaceholder is-locked" style="max-height: 802px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 114.6%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*DScp0KtJi1-7dWXgbVvnPQ.png" data-action="zoom" data-height="1398" data-image-id="1*DScp0KtJi1-7dWXgbVvnPQ.png" data-scroll="native" data-width="1220"></div></div></figure><figure class="graf graf--figure graf-after--p" id="877b" name="877b"><div class="aspectRatioPlaceholder is-locked" style="max-height: 802px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*DScp0KtJi1-7dWXgbVvnPQ.png" data-action="zoom" data-height="1398" data-image-id="1*DScp0KtJi1-7dWXgbVvnPQ.png" data-scroll="native" data-width="1220"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*DScp0KtJi1-7dWXgbVvnPQ.png" src="https://cdn-images-1.medium.com/max/800/1*DScp0KtJi1-7dWXgbVvnPQ.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="f7bc" name="f7bc">Add a survey prompt for the <strong class="markup--strong markup--p-strong">VM Type</strong>. Press <strong class="markup--strong markup--p-strong">Add</strong>.</div><figure class="graf graf--figure graf-after--p" id="6026" name="6026"><div class="aspectRatioPlaceholder is-locked" style="max-height: 855px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 122.10000000000001%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*i096pFp_e6S9-jnYXeA5Sg.png" data-action="zoom" data-height="1470" data-image-id="1*i096pFp_e6S9-jnYXeA5Sg.png" data-scroll="native" data-width="1204"></div></div></figure><figure class="graf graf--figure graf-after--p" id="6026" name="6026"><div class="aspectRatioPlaceholder is-locked" style="max-height: 855px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*i096pFp_e6S9-jnYXeA5Sg.png" data-action="zoom" data-height="1470" data-image-id="1*i096pFp_e6S9-jnYXeA5Sg.png" data-scroll="native" data-width="1204"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*i096pFp_e6S9-jnYXeA5Sg.png" src="https://cdn-images-1.medium.com/max/800/1*i096pFp_e6S9-jnYXeA5Sg.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="02dc" name="02dc">Add a survey prompt for the <strong class="markup--strong markup--p-strong">Storage Repository</strong>. Adjust the choices to match the different types you have on your servers — <em class="markup--em markup--p-em">this has to be the exact names of the SR’s</em>. Press <strong class="markup--strong markup--p-strong">Add</strong>.</div><figure class="graf graf--figure graf-after--p" id="5381" name="5381"><div class="aspectRatioPlaceholder is-locked" style="max-height: 857px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 122.39999999999999%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*yWRxFf75BEt_pxonoIeGsA.png" data-action="zoom" data-height="1476" data-image-id="1*yWRxFf75BEt_pxonoIeGsA.png" data-scroll="native" data-width="1206"></div></div></figure><figure class="graf graf--figure graf-after--p" id="5381" name="5381"><div class="aspectRatioPlaceholder is-locked" style="max-height: 857px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*yWRxFf75BEt_pxonoIeGsA.png" data-action="zoom" data-height="1476" data-image-id="1*yWRxFf75BEt_pxonoIeGsA.png" data-scroll="native" data-width="1206"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*yWRxFf75BEt_pxonoIeGsA.png" src="https://cdn-images-1.medium.com/max/800/1*yWRxFf75BEt_pxonoIeGsA.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="2e99" name="2e99">Add a survey prompt for the <strong class="markup--strong markup--p-strong">DNS Servers</strong>. Press <strong class="markup--strong markup--p-strong">Add</strong>.</div><figure class="graf graf--figure graf-after--p" id="8d41" name="8d41"><div class="aspectRatioPlaceholder is-locked" style="max-height: 795px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 113.5%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*5c85PashlCEPWA1JNuxXmA.png" data-action="zoom" data-height="1362" data-image-id="1*5c85PashlCEPWA1JNuxXmA.png" data-scroll="native" data-width="1200"></div></div></figure><figure class="graf graf--figure graf-after--p" id="8d41" name="8d41"><div class="aspectRatioPlaceholder is-locked" style="max-height: 795px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*5c85PashlCEPWA1JNuxXmA.png" data-action="zoom" data-height="1362" data-image-id="1*5c85PashlCEPWA1JNuxXmA.png" data-scroll="native" data-width="1200"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*5c85PashlCEPWA1JNuxXmA.png" src="https://cdn-images-1.medium.com/max/800/1*5c85PashlCEPWA1JNuxXmA.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="942d" name="942d">Add a survey prompt for the <strong class="markup--strong markup--p-strong">VM Template</strong>. Again, these template names <em class="markup--em markup--p-em">should match the names of the templates on your servers exactly</em>. Press <strong class="markup--strong markup--p-strong">Add</strong>.</div><figure class="graf graf--figure graf-after--p" id="ea80" name="ea80"><div class="aspectRatioPlaceholder is-locked" style="max-height: 841px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 120.19999999999999%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*dRlHm2ifGdQulbRjN2l9Bw.png" data-action="zoom" data-height="1452" data-image-id="1*dRlHm2ifGdQulbRjN2l9Bw.png" data-scroll="native" data-width="1208"></div></div></figure><figure class="graf graf--figure graf-after--p" id="ea80" name="ea80"><div class="aspectRatioPlaceholder is-locked" style="max-height: 841px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*dRlHm2ifGdQulbRjN2l9Bw.png" data-action="zoom" data-height="1452" data-image-id="1*dRlHm2ifGdQulbRjN2l9Bw.png" data-scroll="native" data-width="1208"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*dRlHm2ifGdQulbRjN2l9Bw.png" src="https://cdn-images-1.medium.com/max/800/1*dRlHm2ifGdQulbRjN2l9Bw.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="e767" name="e767">Now save the whole survey. Press <strong class="markup--strong markup--p-strong">Save</strong> in the bottom right corner.</div><figure class="graf graf--figure graf-after--p" id="8264" name="8264"><div class="aspectRatioPlaceholder is-locked" style="max-height: 337px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 48.1%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*B8F_MLSmawaEeJtU27xN8w.png" data-action="zoom" data-height="580" data-image-id="1*B8F_MLSmawaEeJtU27xN8w.png" data-scroll="native" data-width="1206"></div></div></figure><figure class="graf graf--figure graf-after--p" id="8264" name="8264"><div class="aspectRatioPlaceholder is-locked" style="max-height: 337px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*B8F_MLSmawaEeJtU27xN8w.png" data-action="zoom" data-height="580" data-image-id="1*B8F_MLSmawaEeJtU27xN8w.png" data-scroll="native" data-width="1206"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*B8F_MLSmawaEeJtU27xN8w.png" src="https://cdn-images-1.medium.com/max/800/1*B8F_MLSmawaEeJtU27xN8w.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="cf2d" name="cf2d">Now you can run the job from the <strong class="markup--strong markup--p-strong">Portal Mode</strong>. Just click the <strong class="markup--strong markup--p-strong">Rocket</strong> icon to the right of the Job template name.</div><figure class="graf graf--figure graf-after--p" id="18aa" name="18aa"><div class="aspectRatioPlaceholder is-locked" style="max-height: 303px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 43.3%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*_cpau0UNKy30qO5v3ZtVAg.png" data-action="zoom" data-height="718" data-image-id="1*_cpau0UNKy30qO5v3ZtVAg.png" data-scroll="native" data-width="1658"></div></div></figure><figure class="graf graf--figure graf-after--p" id="18aa" name="18aa"><div class="aspectRatioPlaceholder is-locked" style="max-height: 303px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*_cpau0UNKy30qO5v3ZtVAg.png" data-action="zoom" data-height="718" data-image-id="1*_cpau0UNKy30qO5v3ZtVAg.png" data-scroll="native" data-width="1658"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*_cpau0UNKy30qO5v3ZtVAg.png" src="https://cdn-images-1.medium.com/max/800/1*_cpau0UNKy30qO5v3ZtVAg.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="7100" name="7100">Because  of the problem I explained earlier with the credentials, we now have to  choose a credential from a list. Choose one and press <strong class="markup--strong markup--p-strong">Next</strong>.</div><figure class="graf graf--figure graf-after--p" id="cab6" name="cab6"><div class="aspectRatioPlaceholder is-locked" style="max-height: 442px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 63.2%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*ffjOZTt6cm9N5qrARChreQ.png" data-action="zoom" data-height="1012" data-image-id="1*ffjOZTt6cm9N5qrARChreQ.png" data-scroll="native" data-width="1602"></div></div></figure><figure class="graf graf--figure graf-after--p" id="cab6" name="cab6"><div class="aspectRatioPlaceholder is-locked" style="max-height: 442px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*ffjOZTt6cm9N5qrARChreQ.png" data-action="zoom" data-height="1012" data-image-id="1*ffjOZTt6cm9N5qrARChreQ.png" data-scroll="native" data-width="1602"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*ffjOZTt6cm9N5qrARChreQ.png" src="https://cdn-images-1.medium.com/max/800/1*ffjOZTt6cm9N5qrARChreQ.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="9dd7" name="9dd7">Then  we have to choose the Xenserver to deploy to. This list is pulled from  the inventory file (hosts file). Choose a Xenserver and press <strong class="markup--strong markup--p-strong">Next</strong>.</div><figure class="graf graf--figure graf-after--p" id="bbc6" name="bbc6"><div class="aspectRatioPlaceholder is-locked" style="max-height: 348px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 49.8%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*JPxgDqo9G79CXmLuYDQk3g.png" data-action="zoom" data-height="800" data-image-id="1*JPxgDqo9G79CXmLuYDQk3g.png" data-scroll="native" data-width="1608"></div></div></figure><figure class="graf graf--figure graf-after--p" id="bbc6" name="bbc6"><div class="aspectRatioPlaceholder is-locked" style="max-height: 348px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*JPxgDqo9G79CXmLuYDQk3g.png" data-action="zoom" data-height="800" data-image-id="1*JPxgDqo9G79CXmLuYDQk3g.png" data-scroll="native" data-width="1608"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*JPxgDqo9G79CXmLuYDQk3g.png" src="https://cdn-images-1.medium.com/max/800/1*JPxgDqo9G79CXmLuYDQk3g.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="0231" name="0231">We’re  now presented with the survey that we’ve created earlier. If you’ve  entered sane defaults for everything, you can just press launch, but I  think as a minimum you have to change the IP address for the new VM,  after which you can press <strong class="markup--strong markup--p-strong">Launch</strong>.</div><figure class="graf graf--figure graf-after--p" id="4eba" name="4eba"><div class="aspectRatioPlaceholder is-locked" style="max-height: 348px; max-width: 700px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 49.8%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*MdYzjySsTTdvBgKP2xY5xQ.png" data-action="zoom" data-height="800" data-image-id="1*MdYzjySsTTdvBgKP2xY5xQ.png" data-is-featured="true" data-scroll="native" data-width="1608"></div></div></figure><div class="postArticle-content js-postField js-notesSource js-trackedPost" data-post-id="309798a060b5" data-scroll="native" data-source="post_page" data-tracking-context="postPage"><section class="section section--body section--first section--last" name="1454"><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure class="graf graf--figure graf-after--p" id="4eba" name="4eba"><div class="aspectRatioPlaceholder is-locked" style="max-height: 348px; max-width: 700px;"><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-action-value="1*MdYzjySsTTdvBgKP2xY5xQ.png" data-action="zoom" data-height="800" data-image-id="1*MdYzjySsTTdvBgKP2xY5xQ.png" data-is-featured="true" data-scroll="native" data-width="1608"><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/800/1*MdYzjySsTTdvBgKP2xY5xQ.png" src="https://cdn-images-1.medium.com/max/800/1*MdYzjySsTTdvBgKP2xY5xQ.png" /></div></div></figure><div class="graf graf--p graf-after--figure" id="3d2d" name="3d2d">And now your play should run, and you should end up with a fresh, new VM.</div><div class="graf graf--p graf-after--p graf--trailing" id="5195" name="5195"><br /></div></div></div></section></div></p>

</div>

<hr/>


 Tags:
 <a href="https://blog.indonesiadot.com/tags/xenserver/">xenserver</a>, <a href="https://blog.indonesiadot.com/tags/ansible/">ansible</a>
<hr/>
Dibuat dengan &hearts; menggunakan <a href="https://https://gohugo.io">hugo</a> dengan izin Yang Maha Membuat
<p>&nbsp;</p>

	</div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
  </body>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-147159427-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-147159427-1');
</script>

</html>

