+++
title = "disable / ignore user process at csf firewall"
date = 2019-08-14T16:20:00Z
updated = 2019-08-14T16:20:26Z
blogimport = true 
[author]
	name = "widyamedia"
	uri = "https://www.blogger.com/profile/01098412638320952520"
+++

<br />https://www.google.com/search?q=csf+ignore+user<br /><br />http://g33kinfo.com/info/archives/3933<br /><br /><div style="background-color: white; box-sizing: inherit; color: #6f6e6b; font-family: Merriweather, Georgia, serif; font-size: 16px; margin-bottom: 2em;">From&nbsp;<a href="http://forum.configserver.com/viewtopic.php?t=2059" style="background-color: transparent; box-sizing: inherit; color: #f5876e; text-decoration-line: none;" target="_blank">configserver.com</a></div><div style="background-color: white; box-sizing: inherit; color: #6f6e6b; font-family: Merriweather, Georgia, serif; font-size: 16px; margin-bottom: 2em;"><strong style="box-sizing: inherit;">Process Tracking</strong></div><div style="background-color: white; box-sizing: inherit; color: #6f6e6b; font-family: Merriweather, Georgia, serif; font-size: 16px; margin-bottom: 2em;">This option enables tracking of user and nobody processes and examines them for suspicious executables or open network ports. Its purpose is to identify potential exploit processes that are running on the server, even if they are obfuscated to appear as system services. If a suspicious process is found an alert email is sent with relevant information. It is then the responsibility of the recipient to investigate the process further as the script takes no further action. Processes (PIDs) are only reported once unless lfd is restarted.</div><div style="background-color: white; box-sizing: inherit; color: #6f6e6b; font-family: Merriweather, Georgia, serif; font-size: 16px; margin-bottom: 2em;">There is an ignore file /etc/csf/csf.pignore which can be used to whitelist either usernames or full paths to binaries. Care should be taken with ignoring users or files so that you don’t force false-negatives.</div><div style="background-color: white; box-sizing: inherit; color: #6f6e6b; font-family: Merriweather, Georgia, serif; font-size: 16px; margin-bottom: 2em;">You must use the following format:</div><div style="background-color: white; box-sizing: inherit; color: #6f6e6b; font-family: Merriweather, Georgia, serif; font-size: 16px;"> <li style="box-sizing: inherit;">exe:/full/path/to/file</li><li style="box-sizing: inherit;">user:username</li><li style="box-sizing: inherit;">cmd:command line</li></div><div style="background-color: white; box-sizing: inherit; color: #6f6e6b; font-family: Merriweather, Georgia, serif; font-size: 16px; margin-bottom: 2em;"><span id="more-3933" style="box-sizing: inherit;"></span></div><div style="background-color: white; box-sizing: inherit; color: #6f6e6b; font-family: Merriweather, Georgia, serif; font-size: 16px; margin-bottom: 2em;">The command line as reported in /proc has the trailing null character removed and all other occurrences replaced with a space. So, the line you specify in the file should have space separators for the command line arguments, not null characters. It is strongly recommended that you use command line ignores very carefully as any process can change what is reported to the OS. Don’t list the paths to perl or php as this will prevent detection of suspicious web scripts.</div><div style="background-color: white; box-sizing: inherit; color: #6f6e6b; font-family: Merriweather, Georgia, serif; font-size: 16px; margin-bottom: 2em;"><strong style="box-sizing: inherit;">Process Tracking and csf.pignore</strong></div><div style="background-color: white; box-sizing: inherit; color: #6f6e6b; font-family: Merriweather, Georgia, serif; font-size: 16px; margin-bottom: 2em;">1. If you’re seeing spamd being reported after the latest update and want to ignore it, the following can be added to /etc/csf/csf.pignore (ensure that you ONLY use linux linefeeds, not WIN or MAC ones when editing Linux files):<br style="box-sizing: inherit;" /><code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: inherit; color: #c7254e; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace; font-size: 1em; padding: 2px 4px;"><br style="box-sizing: inherit;" />cmd:spamd child</code><br style="box-sizing: inherit;" />Then restart lfd.</div><div style="background-color: white; box-sizing: inherit; color: #6f6e6b; font-family: Merriweather, Georgia, serif; font-size: 16px; margin-bottom: 2em;">2. If you’re seeing awstats.pl being reported after the latest update and want to ignore it, the following can be added to /etc/csf/csf.pignore:<br style="box-sizing: inherit;" /><code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: inherit; color: #c7254e; font-family: Monaco, Consolas, &quot;Andale Mono&quot;, &quot;DejaVu Sans Mono&quot;, monospace; font-size: 1em; padding: 2px 4px;"><br style="box-sizing: inherit;" />pcmd:.*/usr/local/cpanel/3rdparty/bin/awstats\.pl.*<br style="box-sizing: inherit;" />pcmd:.*/usr/local/cpanel/base/awstats\.pl.*</code><br style="box-sizing: inherit;" />Then restart lfd.</div>
